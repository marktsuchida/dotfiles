{{- /* vim: set filetype=tmux: */ -}}

# Disable `i' for show-message, replace it with opposite of `o'
unbind-key i
bind-key i select-pane -t :.-

# Reverse search to the U+00a0 NO-BREAK SPACE contained in $PS1
bind-key -T copy-mode-vi P \
	send-keys -X start-of-line \; \
	send-keys -X search-backward-text "\u00a0"

set-option -g history-limit 10000

set-option -g default-terminal "screen-256color"

set-option -g aggressive-resize on

set-option -g pane-border-status top
set-option -g pane-border-format '[#{pane_index}: #{pane_current_command} #{pane_width}x#{pane_height}] #{pane_mode}'

# Allow ESC to take effect immediately, without acting as META prefix
set-option escape-time 0

{{- if eq .chezmoi.os "darwin" }}

# Homebrew bash if installed
if-shell '[ -x /opt/homebrew/bin/bash ]' {
	set-option -g default-shell /opt/homebrew/bin/bash
}
if-shell '[ -x /usr/local/bin/bash ]' {
	set-option -g default-shell /usr/local/bin/bash
}

set-option -s copy-command 'pbcopy'

{{- else if eq .chezmoi.os "linux" }}

if-shell '[ -x "$(command -v xsel)" ]' {
	set-option -s copy-command 'xsel -i'  # PRIMARY, not CLIPBOARD
}

{{- end }}

# Ensure that session 'M' always exists. This command will fail if 'M' already
# exists, but silently, since it is the last command in the file. The short
# name 'M' is chosen to occupy the minimal amount of space in the status line.
new-session -d -s M
