ulimit -u 512 -n 1024


# macOS /etc/bashrc sources /etc/bashrc_Apple_Terminal, which sets up
# PROMPT_COMMAND to tell Terminal.app the cwd. I don't need this.
if [ "$PROMPT_COMMAND" = "update_terminal_cwd" ]; then
	unset PROMPT_COMMAND
fi


### Shell aliases
if [ -x "$(command -v ggrep)" ]; then
	alias grep='ggrep --color=auto'
	alias fgrep='gfgrep --color=auto'
	alias egrep='gegrep --color=auto'
fi
alias 'open.'='open .'
alias Preview='open -a Preview'
alias Skim='open -a Skim'
alias acroread='open -a "Adobe Reader.app"'
alias chrome='open -a "Google Chrome.app"'
alias pbcopy='reattach-to-user-namespace pbcopy'
alias pbpaste='reattach-to-user-namespace pbpaste'
alias pbclear='pbcopy < /dev/null'

pbsort()
{
	reattach-to-user-namespace pbpaste | \
		sort "$@" | reattach-to-user-namespace pbcopy
}

manskim()
{
	man -t "$@" | open -f -a Skim
}

manprev()
{
	man -t "$@" | open -f -a Preview
}

doi()
{
	open http://dx.doi.org/${1}
}


### Completions (homebrew)
# This should be sufficient for bash-completion@2 to load everything, including
# the scripts installed in $BASH_COMPLETION_COMPAT_DIR.
source_if_file /usr/local/etc/profile.d/bash_completion.sh


### Application setup

# MacVim
if [ -x /Applications/MacVim.app/Contents/bin/mvim ]; then
	append_if_not_in_path PATH "/Applications/MacVim.app/Contents/bin"
fi


# MacTeX
# PATH and MANPATH are automatically added by system
prepend_if_not_in_path INFOPATH /Library/TeX/Documentation/texmf-doc/info


# Visual Studio Code 'code' command
append_if_not_in_path PATH "/Applications/Visual Studio Code.app/Contents/Resources/app/bin"


# Google Cloud Platform
source_if_file ~/Developer/google-cloud-sdk/path.bash.inc
source_if_file ~/Developer/google-cloud-sdk/completion.bash.inc


# Gnuplot
export GNUTERM=qt


# Go (Homebrew)
if [ -x "$(command -v go)" ]; then
	export GOROOT=/usr/local/opt/go/libexec
	append_if_not_in_path PATH $GOROOT/bin
fi


# Java
export JAVA_HOME=$(/usr/libexec/java_home -v 1.8)
append_if_not_in_path MANPATH "$JAVA_HOME/man"


# Groovy (Homebrew)
if [ -x /usr/local/bin/groovysh ] && [ -d /usr/local/opt/groovy ]; then
	export GROOVY_HOME=/usr/local/opt/groovy/libexec
fi
